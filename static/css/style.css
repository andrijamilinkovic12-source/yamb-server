/* --- 1. CSS VARIJABLE I TEME --- */
:root {
    --bg-body: #0f172a;
    --bg-surface: #1e293b;
    --bg-glass: rgba(30, 41, 59, 0.98);
    --bg-grid: #334155;
    --text-main: #f8fafc;
    --text-muted: #94a3b8;
    --primary: #38bdf8;
    --gold: #fbbf24;
    --danger: #ef4444;
    --success: #22c55e;
    --btn-bg: #334155;
    
    --dice-bg: #f8fafc;
    --dice-text: #0f172a;
    --dice-held-bg: #ef4444;
    --dice-held-text: #ffffff;
    
    /* Boje kolona */
    --col-nadole: #60a5fa;   /* Plava */
    --col-nagore: #f43f5e;   /* Crvena */
    --col-sredina: #fb923c;  /* Narandžasta */
    --col-rucno: #c084fc;    /* Ljubičasta */
    --col-najava: #facc15;   /* Žuta */
    --col-slobodna: #cbd5e1; /* Siva */
    
    --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
}

body.light-theme {
    --bg-body: #f1f5f9;
    --bg-surface: #ffffff;
    --bg-glass: rgba(255, 255, 255, 0.98);
    --bg-grid: #cbd5e1;
    --text-main: #0f172a;
    --text-muted: #64748b;
    --btn-bg: #e2e8f0;
    --dice-bg: #ffffff;
    --dice-text: #0f172a;
    
    --col-nadole: #2563eb;
    --col-nagore: #dc2626;
    --col-sredina: #d97706;
    --col-rucno: #9333ea;
    --col-najava: #b45309;
    --col-slobodna: #475569;
}

/* --- 2. GLOBALNI STILOVI --- */
* { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

body { 
    background-color: var(--bg-body); 
    color: var(--text-main); 
    font-family: 'Inter', sans-serif; 
    margin: 0; 
    height: 100vh; 
    display: flex; 
    flex-direction: column; 
    overflow: hidden; 
    user-select: none;
    transition: background 0.3s, color 0.3s;
}

button { 
    font-family: 'Inter', sans-serif; 
    font-weight: 600; 
    border: none; 
    cursor: pointer; 
    padding: 10px; 
    outline: none; 
    border-radius: 8px; 
    transition: 0.2s; 
}
button:active { transform: scale(0.96); }
button:disabled { opacity: 0.5; cursor: not-allowed; filter: grayscale(1); }
.hidden { display: none !important; }

/* --- 3. MENI I HERO EKRAN --- */
#menu-screen { 
    display: flex; 
    flex-direction: column; 
    align-items: center; 
    height: 100%; 
    overflow-y: auto; 
    padding: 20px; 
    background: radial-gradient(circle at top, var(--bg-surface), var(--bg-body)); 
    text-align: center; 
}

.hero-title { 
    font-size: 32px; 
    font-weight: 800; 
    background: linear-gradient(135deg, var(--primary), var(--gold)); 
    -webkit-background-clip: text; 
    -webkit-text-fill-color: transparent; 
    margin: 30px 0 10px; 
    letter-spacing: -1px;
    line-height: 1.2;
    text-transform: uppercase;
}

.menu-btn { 
    width: 100%; 
    max-width: 300px; 
    margin: 6px 0; 
    background: var(--btn-bg); 
    color: var(--text-main); 
    font-size: 15px; 
    padding: 14px; 
    box-shadow: 0 2px 5px rgba(0,0,0,0.1); 
}
.menu-btn.online { background: #2563eb; color: white; }
.menu-btn.gold { background: var(--gold); color: #0f172a; }
.menu-btn.rules-btn { border: 1px solid var(--text-muted); background: transparent; }
.menu-btn.donate { background: #0070BA; color: white; margin-top: 15px; }
.menu-btn.exit { color: var(--danger); background: transparent; border: 1px solid var(--danger); }

/* --- 4. MODALI --- */
.modal-overlay { 
    position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
    background: rgba(0,0,0,0.7); backdrop-filter: blur(5px); 
    z-index: 2000; 
    display: flex; align-items: center; justify-content: center; padding: 10px; 
}
.modal-content { 
    background: var(--bg-surface); 
    padding: 25px; 
    border-radius: 20px; 
    width: 100%; 
    max-width: 400px; 
    text-align: center; 
    box-shadow: var(--shadow-lg); 
    max-height: 90vh; 
    overflow-y: auto; 
    border: 1px solid var(--bg-grid); 
}
.modal-content h2 { color: var(--primary); margin-top: 0; }
input[type="text"] { 
    width: 100%; padding: 12px; border-radius: 8px; 
    border: 1px solid var(--bg-grid); background: var(--bg-body); 
    color: var(--text-main); margin-bottom: 15px; font-size: 16px; 
}

/* --- 5. GAME UI (Board) --- */
#game-screen { display: flex; flex-direction: column; height: 100%; }

header { 
    height: 45px; 
    display: flex; justify-content: space-between; align-items: center; 
    padding: 0 15px; background: var(--bg-surface); 
    border-bottom: 1px solid var(--bg-grid); 
    z-index: 10; flex-shrink: 0; 
}
.header-btn { background: transparent; color: var(--text-muted); font-size: 18px; padding: 5px; }

.content-area { 
    flex: 1; 
    overflow-y: auto; 
    padding: 10px; 
    padding-bottom: 200px; /* Mesto za kontrole */
    display: flex; 
    justify-content: center; 
    align-items: flex-start;
    -webkit-overflow-scrolling: touch;
}

.tables-container { 
    display: flex; 
    justify-content: center; 
    gap: 20px; 
    width: 100%; 
    flex-wrap: wrap; 
}

/* TABELA IGRAČA */
.player-table { 
    background: var(--bg-surface); 
    border-radius: 10px; 
    box-shadow: var(--shadow-lg); 
    width: 100%; 
    max-width: 500px; 
    margin: 0 auto; 
    display: flex; flex-direction: column; overflow: hidden; 
    border: 2px solid transparent;
    transition: border-color 0.3s;
}
.player-table.active { border-color: var(--primary); }

.player-name { 
    padding: 6px; font-weight: 700; text-align: center; 
    color: var(--primary); text-transform: uppercase; letter-spacing: 1px; 
    background: var(--bg-grid); width: 100%; font-size: 13px;
}

.table-responsive { width: 100%; overflow-x: auto; -webkit-overflow-scrolling: touch; }

.grid-container { 
    display: grid; 
    grid-template-columns: 1.5fr repeat(6, 1fr); 
    gap: 1px; 
    background: var(--bg-grid); 
    border: 1px solid var(--bg-grid);
    width: 100%;
    min-width: 320px; 
}

.grid-cell { 
    background: var(--bg-surface); 
    display: flex; align-items: center; justify-content: center; 
    font-size: 13px; 
    height: 28px; 
}
.col-header { font-weight: 700; font-size: 12px; background: var(--bg-surface); }
.row-header { justify-content: flex-end; padding-right: 5px; color: var(--text-muted); font-size: 11px; font-weight: 600; }

.score-btn { 
    width: 100%; height: 100%; background: transparent; 
    color: var(--text-muted); font-weight: 700; font-size: 13px; border-radius: 0; 
}
.score-btn.filled { color: var(--text-main); background: rgba(255,255,255,0.05); }
.score-btn.highlight-najava { 
    background: var(--col-najava) !important; 
    color: black !important; 
    animation: pulse 1s infinite; 
}

.total-score { 
    width: 100%; background: var(--bg-grid); color: var(--gold);
    text-align: center; padding: 8px 0; font-size: 22px; font-weight: 800;
    text-shadow: 0 1px 2px rgba(0,0,0,0.5); margin-top: 0;
}

/* --- 6. KONTROLE (Fixed Bottom) --- */
.controls-fixed { 
    position: fixed; bottom: 0; left: 0; width: 100%; 
    background: var(--bg-glass); backdrop-filter: blur(10px); 
    padding: 12px; border-top: 1px solid var(--bg-grid); 
    z-index: 100; box-shadow: 0 -5px 20px rgba(0,0,0,0.3); 
}

.dice-container { display: flex; justify-content: center; gap: 10px; margin-bottom: 12px; }

.dice { 
    width: 54px; height: 54px; 
    background: var(--dice-bg); color: var(--dice-text); 
    border-radius: 12px; 
    display: flex; align-items: center; justify-content: center; 
    font-size: 34px; cursor: pointer; 
    box-shadow: 0 4px 0 #94a3b8; border: 1px solid rgba(0,0,0,0.1); 
    user-select: none; 
    transition: transform 0.2s, background 0.3s;
}
.dice.held { 
    background: var(--dice-held-bg); color: var(--dice-held-text); 
    transform: translateY(3px); box-shadow: none !important; 
}

.action-row { display: flex; gap: 8px; max-width: 600px; margin: 0 auto; align-items: center; }
.status-info { flex: 1; font-size: 11px; color: var(--text-muted); line-height: 1.2; }
.status-info span { color: var(--primary); font-weight: bold; font-size: 13px; display: block; }
.btn-game { flex: 1; padding: 12px 0; font-size: 13px; font-weight: bold; text-transform: uppercase; }
.btn-roll { background: linear-gradient(135deg, var(--primary), #2563eb); color: white; flex: 2; box-shadow: 0 4px 10px rgba(37,99,235,0.4); }
.btn-najava { background: var(--bg-grid); color: var(--text-main); }

/* --- 7. CHAT & EXT --- */
.chat-fab { 
    position: fixed; bottom: 160px; right: 15px; 
    width: 48px; height: 48px; border-radius: 50%; 
    background: var(--primary); color: white; 
    display: flex; align-items: center; justify-content: center; 
    font-size: 22px; cursor: pointer; z-index: 90; 
    box-shadow: 0 5px 15px rgba(0,0,0,0.3); 
}
.chat-fab.alert { background: var(--danger); animation: pulse 1.5s infinite; }

/* BOJE KOLONA */
.c-nadole { color: var(--col-nadole); }
.c-nagore { color: var(--col-nagore); }
.c-sredina { color: var(--col-sredina); }
.c-rucno { color: var(--col-rucno); }
.c-najava { color: var(--col-najava); }
.c-slobodna { color: var(--col-slobodna); }

/* LOADER & BANNERS */
.loader { border: 4px solid var(--bg-grid); border-top: 4px solid var(--primary); border-radius: 50%; width: 40px; height: 40px; animation: spin 1s linear infinite; margin-bottom: 20px; }
@keyframes spin { 100% { transform: rotate(360deg); } }

.ad-banner { background: var(--bg-grid); color: var(--text-muted); display: flex; align-items: center; justify-content: center; font-size: 10px; border-radius: 6px; border: 1px dashed var(--text-muted); position: relative; overflow: hidden; }
.ad-banner::after { content: "REKLAMA"; opacity: 0.5; font-weight: bold; }
.menu-ad-top { width: 300px; height: 50px; margin: 10px 0; }
.menu-ad-bottom { width: 300px; height: 100px; margin-top: 20px; }

/* --- 8. ANIMACIJE --- */

/* 3D Roll Animacija */
.dice.rolling {
    animation: roll3D 0.6s ease-out forwards;
    color: transparent !important;
    background-color: var(--dice-bg);
    box-shadow: 0 0 10px var(--primary);
}

@keyframes roll3D {
    0% { transform: rotateZ(0deg) rotateX(0deg) scale(1); }
    50% { transform: rotateZ(180deg) rotateX(180deg) scale(1.1); }
    100% { transform: rotateZ(360deg) rotateX(360deg) scale(1); }
}

/* Pulsiranje za upozorenja */
@keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.1); } 100% { transform: scale(1); } }

/* Pulsiranje teksta za status protivnika */
#lbl-turn { transition: color 0.3s; }
#lbl-turn[style*="var(--primary)"] { animation: pulseText 1.5s infinite; }

@keyframes pulseText {
    0% { opacity: 1; }
    50% { opacity: 0.6; }
    100% { opacity: 1; }
}

/* --- Universal Modal Dugmići --- */
.u-modal-btns { display: flex; gap: 10px; justify-content: center; margin-top: 20px; }
.u-modal-btn { flex: 1; padding: 12px; border-radius: 8px; font-weight: bold; }
.u-btn-ok { background: var(--primary); color: white; }
.u-btn-cancel { background: transparent; border: 1px solid var(--text-muted); color: var(--text-muted); }

/* Pravila igre kartice */
.rules-wrapper { max-width: 800px; width: 100%; padding: 20px; }
.rules-card { background: var(--bg-surface); padding: 20px; border-radius: 12px; margin-bottom: 15px; line-height: 1.5; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
.rules-card h3 { color: var(--primary); margin-top: 0; border-bottom: 1px solid var(--bg-grid); padding-bottom: 5px; }